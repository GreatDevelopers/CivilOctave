\hypertarget{namespacecivilsage_1_1views}{}\section{civilsage.\+views Namespace Reference}
\label{namespacecivilsage_1_1views}\index{civilsage.\+views@{civilsage.\+views}}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{namespacecivilsage_1_1views_a7b4fd4478a312ce8e35a192159c59de9}{index} (request)
\item 
def \hyperlink{namespacecivilsage_1_1views_a8b58c93a9c82e84143c43dafaa744a4b}{matrix} (request)
\item 
def \hyperlink{namespacecivilsage_1_1views_aed47fb0740a2fa14693f697905788719}{last} (request)
\item 
def \hyperlink{namespacecivilsage_1_1views_a32de127956738677913352a2db84ecdb}{file} (request)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
\begin{DoxyVerb}@package docstring
This module contain functions to controls veiws
...
\end{DoxyVerb}
 

\subsection{Function Documentation}
\hypertarget{namespacecivilsage_1_1views_a32de127956738677913352a2db84ecdb}{}\index{civilsage\+::views@{civilsage\+::views}!file@{file}}
\index{file@{file}!civilsage\+::views@{civilsage\+::views}}
\subsubsection[{file(request)}]{\setlength{\rightskip}{0pt plus 5cm}def civilsage.\+views.\+file (
\begin{DoxyParamCaption}
\item[{}]{request}
\end{DoxyParamCaption}
)}\label{namespacecivilsage_1_1views_a32de127956738677913352a2db84ecdb}
\begin{DoxyVerb}Documentation for a function
This veiw take input data from file uploaded by user and processes
to give output in form of response
\end{DoxyVerb}
 
\begin{DoxyCode}
184 \textcolor{keyword}{def }\hyperlink{namespacecivilsage_1_1views_a32de127956738677913352a2db84ecdb}{file}(request):
185 
186     \textcolor{stringliteral}{"""Documentation for a function}
187 \textcolor{stringliteral}{    This veiw take input data from file uploaded by user and processes}
188 \textcolor{stringliteral}{    to give output in form of response}
189 \textcolor{stringliteral}{    """}
190 
191     message=\textcolor{stringliteral}{'please fill again'}
192     \textcolor{keywordflow}{try}:
193 
194         \textcolor{comment}{#dictionary of all input tags}
195         lists = \{\textcolor{stringliteral}{'Soil\_type'}:\textcolor{stringliteral}{''},\textcolor{stringliteral}{'Number\_of\_storeys'}:\textcolor{stringliteral}{''}
196         ,\textcolor{stringliteral}{'Importance\_factor'}:\textcolor{stringliteral}{''},\textcolor{stringliteral}{'Response\_reduction\_factor'}:\textcolor{stringliteral}{''}
197         ,\textcolor{stringliteral}{'Zone\_factor'}:\textcolor{stringliteral}{''},\textcolor{stringliteral}{'Gravity\_acceleration'}:\textcolor{stringliteral}{''}
198         ,\textcolor{stringliteral}{'Modes\_considered'}:\textcolor{stringliteral}{''}\}
199 
200         \textcolor{comment}{#name of directory of specific user}
201         name=\textcolor{stringliteral}{''}
202 
203         \textcolor{comment}{#getting input using tags}
204         \textcolor{keywordflow}{for} var \textcolor{keywordflow}{in} lists.keys():
205             lists[var]=request.session.get(var)
206             name=name+str(lists[var])
207 
208         command=\textcolor{stringliteral}{'cp -r sagemath '}+name
209         os.popen(command)
210 
211         \textcolor{comment}{#opening file for writing}
212         command=name+\textcolor{stringliteral}{'/input.sage'}
213         file = open(command, \textcolor{stringliteral}{'w'})
214 
215         \textcolor{comment}{#writing variables in input.sage file with syntax of sage}
216         \textcolor{keywordflow}{for} var \textcolor{keywordflow}{in} lists.keys():
217             file.write(var)
218             file.write(\textcolor{stringliteral}{'='})
219             file.write(lists[var])
220             file.write(\textcolor{stringliteral}{'\(\backslash\)n'})
221         file.close()
222 
223         \textcolor{comment}{#getting file uploaded by user}
224         f=request.FILES[\textcolor{stringliteral}{"input\_file"}]
225         print(f.content\_type)
226         \hyperlink{bootstrap_8min_8js_ac2d69f5011896c6ed4a54e0dd36f6334}{if}(f.content\_type != \textcolor{stringliteral}{'text/csv'}):
227             \textcolor{keywordflow}{return} render( request,\textcolor{stringliteral}{'civilsage/file.html'},
228             \{\textcolor{stringliteral}{'email\_get'}: request.session.get(\textcolor{stringliteral}{'email\_get'}),
229             \textcolor{stringliteral}{'message'}:\textcolor{stringliteral}{'File Not in CSV FORMAT '}\})
230         data = [row \textcolor{keywordflow}{for} row \textcolor{keywordflow}{in} csv.reader(f)]
231 
232         \textcolor{comment}{#getting numbers of storeys}
233         num = request.session.get(\textcolor{stringliteral}{'Number\_of\_storeys'})
234 
235         \textcolor{comment}{#checking if number values are not less than required values}
236         \textcolor{comment}{#if(len(data)<3*int(num)):}
237             \textcolor{comment}{#return render( request,'civilsage/file.html')}
238         \textcolor{comment}{#opening input.sage to append remaining inputs}
239         command=name+\textcolor{stringliteral}{'/input.sage'}
240         file=open(command,\textcolor{stringliteral}{'a'})
241 
242         \textcolor{comment}{#list of basic tags}
243         var = [\textcolor{stringliteral}{'mass'},\textcolor{stringliteral}{'Height\_storey'},\textcolor{stringliteral}{'Stiffness\_storey'}]
244         jar=0
245 
246         \textcolor{comment}{#writing matix into sage file}
247         \textcolor{keywordflow}{for} j \textcolor{keywordflow}{in} var:
248             message=\textcolor{stringliteral}{"Less no. of rows in csv file"}
249             file.write(j)
250             file.write(\textcolor{stringliteral}{'=matrix(['})
251 
252             \textcolor{comment}{#writing elements of matix}
253             \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(int(num)):
254                 file.write(\textcolor{stringliteral}{'['})
255 
256                 \textcolor{comment}{#getting input from tags}
257                 message=\textcolor{stringliteral}{"Less no. of elements in row "}+str(i)
258                 \hyperlink{bootstrap_8min_8js_ac2d69f5011896c6ed4a54e0dd36f6334}{if}(\textcolor{keywordflow}{not} data[jar][i].isdigit()):
259                     ii=i+1
260                 \textcolor{keywordflow}{else}:
261                     ii=i
262                 d=data[jar][ii]
263                 print(d)
264                 file.write(str(d))
265                 file.write(\textcolor{stringliteral}{']'})
266 
267                 \textcolor{comment}{#condition to check last element}
268                 \hyperlink{bootstrap_8min_8js_ac2d69f5011896c6ed4a54e0dd36f6334}{if}( i!=int(num)+jar-1):
269                     file.write(\textcolor{stringliteral}{','})
270             jar=jar+1
271             file.write(\textcolor{stringliteral}{'])\(\backslash\)n'})
272         file.close()
273 
274         \textcolor{comment}{#creating and writing sh file for background processing}
275         command=name+\textcolor{stringliteral}{'/civil.sh'}
276         file=open(command,\textcolor{stringliteral}{'w'})
277         command=\textcolor{stringliteral}{'cd '}+name
278         file.write(command)
279         file.write(\textcolor{stringliteral}{'\(\backslash\)nlatex civil.tex\(\backslash\)nsage civil.sagetex.sage\(\backslash\)n'})
280         file.write(\textcolor{stringliteral}{'pdflatex civil.tex\(\backslash\)n'})
281         file.close()
282 
283         \textcolor{comment}{#calling sh file for background processing}
284         command=\textcolor{stringliteral}{'sh '}+name+\textcolor{stringliteral}{'/civil.sh'}
285         os.system(command)
286 
287         \textcolor{comment}{#opening creted pdf to display to user}
288         command=name+\textcolor{stringliteral}{'/civil.pdf'}
289         f=open(command)
290 
291         \textcolor{comment}{#sending pdf as response}
292         response = HttpResponse(f,content\_type=\textcolor{stringliteral}{'application/pdf'})
293         response[\textcolor{stringliteral}{'Content-Disposition'}] = \textcolor{stringliteral}{'attachment; filename="civil.pdf"'}
294         print(request.POST.get(\textcolor{stringliteral}{'email\_id'}))
295         \hyperlink{bootstrap_8min_8js_ac2d69f5011896c6ed4a54e0dd36f6334}{if}(request.POST.get(\textcolor{stringliteral}{'email\_id'})):
296             print(request.POST.get(\textcolor{stringliteral}{'email\_id'}))
297             email\_id=request.POST.get(\textcolor{stringliteral}{'email\_id'})
298             user\_email = EmailMessage(\textcolor{stringliteral}{'Your PDF is ready!'},
299             \textcolor{stringliteral}{'You have is ready'}, to=[email\_id])
300             user\_email.attach\_file(command)
301             user\_email.send()
302             command=\textcolor{stringliteral}{'rm -rf '}+name
303             os.system(command)
304             \textcolor{keywordflow}{return} render(request, \textcolor{stringliteral}{"civilsage/index.html"}, \{\})
305         \textcolor{keywordflow}{else}:
306 
307             \textcolor{comment}{#deleting temperary files}
308             print(request.POST.get(\textcolor{stringliteral}{'email\_id'}))
309             command=\textcolor{stringliteral}{'rm -rf '}+name
310             os.system(command)
311             \textcolor{keywordflow}{return} response
312     \textcolor{keywordflow}{except}:
313         \textcolor{keywordflow}{return} render(request, \textcolor{stringliteral}{"civilsage/file.html"},
314         \{\textcolor{stringliteral}{'message'}:message,\textcolor{stringliteral}{'email\_get'}:request.session.get(\textcolor{stringliteral}{'email\_get'})\})
315 \end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=246pt]{namespacecivilsage_1_1views_a32de127956738677913352a2db84ecdb_cgraph}
\end{center}
\end{figure}


\hypertarget{namespacecivilsage_1_1views_a7b4fd4478a312ce8e35a192159c59de9}{}\index{civilsage\+::views@{civilsage\+::views}!index@{index}}
\index{index@{index}!civilsage\+::views@{civilsage\+::views}}
\subsubsection[{index(request)}]{\setlength{\rightskip}{0pt plus 5cm}def civilsage.\+views.\+index (
\begin{DoxyParamCaption}
\item[{}]{request}
\end{DoxyParamCaption}
)}\label{namespacecivilsage_1_1views_a7b4fd4478a312ce8e35a192159c59de9}
\begin{DoxyVerb}first veiw created by rendering html page
from templete
...
\end{DoxyVerb}
 
\begin{DoxyCode}
14 \textcolor{keyword}{def }\hyperlink{namespacecivilsage_1_1views_a7b4fd4478a312ce8e35a192159c59de9}{index}(request):
15     \textcolor{stringliteral}{"""}
16 \textcolor{stringliteral}{    first veiw created by rendering html page}
17 \textcolor{stringliteral}{    from templete}
18 \textcolor{stringliteral}{    ...}
19 \textcolor{stringliteral}{    """}
20 
21     \textcolor{keywordflow}{return} render(request, \textcolor{stringliteral}{'civilsage/index.html'})
22 
\end{DoxyCode}
\hypertarget{namespacecivilsage_1_1views_aed47fb0740a2fa14693f697905788719}{}\index{civilsage\+::views@{civilsage\+::views}!last@{last}}
\index{last@{last}!civilsage\+::views@{civilsage\+::views}}
\subsubsection[{last(request)}]{\setlength{\rightskip}{0pt plus 5cm}def civilsage.\+views.\+last (
\begin{DoxyParamCaption}
\item[{}]{request}
\end{DoxyParamCaption}
)}\label{namespacecivilsage_1_1views_aed47fb0740a2fa14693f697905788719}
\begin{DoxyVerb}This function gets request from matix.html and
gives pdf as output to user
...
\end{DoxyVerb}
 
\begin{DoxyCode}
71 \textcolor{keyword}{def }\hyperlink{namespacecivilsage_1_1views_aed47fb0740a2fa14693f697905788719}{last}(request):
72     \textcolor{stringliteral}{"""}
73 \textcolor{stringliteral}{}
74 \textcolor{stringliteral}{    This function gets request from matix.html and}
75 \textcolor{stringliteral}{    gives pdf as output to user}
76 \textcolor{stringliteral}{    ...}
77 \textcolor{stringliteral}{    """}
78 
79     message=\textcolor{stringliteral}{'error occured please fill again'}
80 
81     \textcolor{comment}{#dictionary of all input tags}
82     lists = \{\textcolor{stringliteral}{'Soil\_type'}:\textcolor{stringliteral}{''},\textcolor{stringliteral}{'Number\_of\_storeys'}:\textcolor{stringliteral}{''}
83     ,\textcolor{stringliteral}{'Importance\_factor'}:\textcolor{stringliteral}{''},\textcolor{stringliteral}{'Response\_reduction\_factor'}:\textcolor{stringliteral}{''}
84     ,\textcolor{stringliteral}{'Zone\_factor'}:\textcolor{stringliteral}{''},\textcolor{stringliteral}{'Gravity\_acceleration'}:\textcolor{stringliteral}{''}
85     ,\textcolor{stringliteral}{'Modes\_considered'}:\textcolor{stringliteral}{''}\}
86     \textcolor{keywordflow}{try}:
87 
88         \textcolor{comment}{#name of directory of specific user}
89         name=\textcolor{stringliteral}{''}
90 
91         \textcolor{comment}{#getting input using tags}
92         \textcolor{keywordflow}{for} var \textcolor{keywordflow}{in} lists.keys():
93             lists[var]=request.session.get(var)
94             name=name+str(lists[var])
95         print(request.session.get(var))
96         command=\textcolor{stringliteral}{'cp -r sagemath '}+name
97         os.popen(command)
98 
99         \textcolor{comment}{#opening file for writing}
100         command=name+\textcolor{stringliteral}{'/input.sage'}
101         file = open(command, \textcolor{stringliteral}{'w'})
102 
103         \textcolor{comment}{#writing variables in input.sage file with syntax of sage}
104         \textcolor{keywordflow}{for} var \textcolor{keywordflow}{in} lists.keys():
105             file.write(var)
106             file.write(\textcolor{stringliteral}{'='})
107             file.write(lists[var])
108             file.write(\textcolor{stringliteral}{'\(\backslash\)n'})
109         file.close()
110 
111         \textcolor{comment}{#getting numbers of storeys}
112         num = request.session.get(\textcolor{stringliteral}{'Number\_of\_storeys'})
113 
114         \textcolor{comment}{#opening input.sage to append remaining inputs}
115         command=name+\textcolor{stringliteral}{'/input.sage'}
116         file=open(command,\textcolor{stringliteral}{'a'})
117 
118         \textcolor{comment}{#list of basic tags}
119         var = [\textcolor{stringliteral}{'mass'},\textcolor{stringliteral}{'Height\_storey'},\textcolor{stringliteral}{'Stiffness\_storey'}]
120 
121         \textcolor{comment}{#writing matix into sage file}
122         \textcolor{keywordflow}{for} j \textcolor{keywordflow}{in} var:
123             file.write(j)
124             file.write(\textcolor{stringliteral}{'=matrix(['})
125 
126             \textcolor{comment}{#writing elements of matix}
127             \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(int(num)):
128 
129                 \textcolor{comment}{#creating input tags}
130                 temp = j+str(i)
131                 file.write(\textcolor{stringliteral}{'['})
132 
133                 \textcolor{comment}{#getting input from tags}
134                 d=request.POST.get(temp)
135                 file.write(d)
136                 file.write(\textcolor{stringliteral}{']'})
137 
138                 \textcolor{comment}{#condition to check last element}
139                 \hyperlink{bootstrap_8min_8js_ac2d69f5011896c6ed4a54e0dd36f6334}{if}( i!=int(num)-1):
140                     file.write(\textcolor{stringliteral}{','})
141             file.write(\textcolor{stringliteral}{'])\(\backslash\)n'})
142         file.close()
143 
144         \textcolor{comment}{#creating and writing sh file for background processing}
145         command=name+\textcolor{stringliteral}{'/civil.sh'}
146         file=open(command,\textcolor{stringliteral}{'w'})
147         command=\textcolor{stringliteral}{'cd '}+name
148         file.write(command)
149         file.write(\textcolor{stringliteral}{'\(\backslash\)nlatex civil.tex\(\backslash\)nsage civil.sagetex.sage\(\backslash\)n'})
150         file.write(\textcolor{stringliteral}{'pdflatex civil.tex\(\backslash\)n'})
151         file.close()
152 
153         \textcolor{comment}{#calling sh file for background processing}
154         command=\textcolor{stringliteral}{'sh '}+name+\textcolor{stringliteral}{'/civil.sh'}
155         os.system(command)
156 
157         \textcolor{comment}{#opening creted pdf to display to user}
158         command=name+\textcolor{stringliteral}{'/civil.pdf'}
159         f=open(command)
160 
161         \textcolor{comment}{#sending pdf as response}
162         response = HttpResponse(f,content\_type=\textcolor{stringliteral}{'application/pdf'})
163         response[\textcolor{stringliteral}{'Content-Disposition'}] = \textcolor{stringliteral}{'attachment; filename="civil.pdf"'}
164         \hyperlink{bootstrap_8min_8js_ac2d69f5011896c6ed4a54e0dd36f6334}{if}(request.GET.get(\textcolor{stringliteral}{'email\_id'})):
165             email\_id=request.POST.get(\textcolor{stringliteral}{'email\_id'})
166             user\_email = EmailMessage(\textcolor{stringliteral}{'Your PDF is ready!'},
167             \textcolor{stringliteral}{'You have is ready'}, to=[email\_id])
168             user\_email.attach\_file(command)
169             user\_email.send()
170             command=\textcolor{stringliteral}{'rm -rf '}+name
171             os.system(command)
172             \textcolor{keywordflow}{return} render(request, \textcolor{stringliteral}{"civilsage/index.html"}, \{\})
173         \textcolor{keywordflow}{else}:
174 
175             \textcolor{comment}{#deleting temperary files}
176             command=\textcolor{stringliteral}{'rm -rf '}+name
177             os.system(command)
178             \textcolor{keywordflow}{return} response
179     \textcolor{keywordflow}{except}:
180         \textcolor{keywordflow}{return} render(request, \textcolor{stringliteral}{"civilsage/matrix.html"},
181         \{\textcolor{stringliteral}{'message'}:message,\textcolor{stringliteral}{'email\_get'}:request.session.get(\textcolor{stringliteral}{'email\_get'})\})
182 
183 
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=248pt]{namespacecivilsage_1_1views_aed47fb0740a2fa14693f697905788719_cgraph}
\end{center}
\end{figure}


\hypertarget{namespacecivilsage_1_1views_a8b58c93a9c82e84143c43dafaa744a4b}{}\index{civilsage\+::views@{civilsage\+::views}!matrix@{matrix}}
\index{matrix@{matrix}!civilsage\+::views@{civilsage\+::views}}
\subsubsection[{matrix(request)}]{\setlength{\rightskip}{0pt plus 5cm}def civilsage.\+views.\+matrix (
\begin{DoxyParamCaption}
\item[{}]{request}
\end{DoxyParamCaption}
)}\label{namespacecivilsage_1_1views_a8b58c93a9c82e84143c43dafaa744a4b}
\begin{DoxyVerb}This function display matrix for input from user and take
response from index veiw and write input taken through index.html
and write in input.sage file
...
\end{DoxyVerb}
 
\begin{DoxyCode}
23 \textcolor{keyword}{def }\hyperlink{namespacecivilsage_1_1views_a8b58c93a9c82e84143c43dafaa744a4b}{matrix}(request):
24     \textcolor{stringliteral}{"""}
25 \textcolor{stringliteral}{    This function display matrix for input from user and take}
26 \textcolor{stringliteral}{    response from index veiw and write input taken through index.html}
27 \textcolor{stringliteral}{    and write in input.sage file}
28 \textcolor{stringliteral}{    ...}
29 \textcolor{stringliteral}{    """}
30 
31     \textcolor{keywordflow}{try}:
32         \textcolor{comment}{#dictionary of all input tags}
33         lists = \{\textcolor{stringliteral}{'Soil\_type'}:\textcolor{stringliteral}{''},\textcolor{stringliteral}{'Number\_of\_storeys'}:\textcolor{stringliteral}{''}
34         ,\textcolor{stringliteral}{'Importance\_factor'}:\textcolor{stringliteral}{''},\textcolor{stringliteral}{'Response\_reduction\_factor'}:\textcolor{stringliteral}{''}
35         ,\textcolor{stringliteral}{'Zone\_factor'}:\textcolor{stringliteral}{''},\textcolor{stringliteral}{'Gravity\_acceleration'}:\textcolor{stringliteral}{''}
36         ,\textcolor{stringliteral}{'Modes\_considered'}:\textcolor{stringliteral}{''},\textcolor{stringliteral}{'email\_get'}:\textcolor{stringliteral}{''}\}
37 
38         \textcolor{comment}{#name of directory of specific user}
39         name = \textcolor{stringliteral}{''}
40 
41         \textcolor{comment}{#getting input using tags and sending it as response}
42         \textcolor{keywordflow}{for} var \textcolor{keywordflow}{in} lists.keys():
43             request.session[var] = request.POST.get(var)
44 
45         \textcolor{comment}{#creating directory from base directory}
46         lists[\textcolor{stringliteral}{'Number\_of\_storeys'}] = request.POST.get(\textcolor{stringliteral}{'Number\_of\_storeys'})
47 
48         \textcolor{comment}{#making list for iteratation in templete}
49         number\_of\_storeys = list()
50         \textcolor{keywordflow}{for} a \textcolor{keywordflow}{in} range(int(lists[\textcolor{stringliteral}{'Number\_of\_storeys'}])):
51             number\_of\_storeys.append(\textcolor{stringliteral}{'a'})
52 
53         \textcolor{comment}{#calling differnet veiws based on option whether}
54         \textcolor{comment}{#user want to upload matrix value through file or}
55         \textcolor{comment}{#manually}
56 
57         \hyperlink{bootstrap_8min_8js_ac2d69f5011896c6ed4a54e0dd36f6334}{if}(request.POST.get(\textcolor{stringliteral}{'through\_file'})==\textcolor{stringliteral}{'Y'}):
58             \textcolor{keywordflow}{return} render( request,\textcolor{stringliteral}{'civilsage/file.html'}
59             ,\{\textcolor{stringliteral}{'number\_of\_storeys'}: number\_of\_storeys,
60             \textcolor{stringliteral}{'email\_get'}: request.POST.get(\textcolor{stringliteral}{'email\_get'})\})
61         \textcolor{keywordflow}{else}:
62             \textcolor{keywordflow}{return} render( request,\textcolor{stringliteral}{'civilsage/matrix.html'}
63             ,\{\textcolor{stringliteral}{'number\_of\_storeys'}: number\_of\_storeys,
64             \textcolor{stringliteral}{'email\_get'}: request.POST.get(\textcolor{stringliteral}{'email\_get'}) \})
65     \textcolor{keywordflow}{except}:
66         \textcolor{keywordflow}{return} render(request, \textcolor{stringliteral}{'civilsage/index.html'}
67         ,\{\textcolor{stringliteral}{'message'}:\textcolor{stringliteral}{'please fill again'}\})
68 
69 
70 
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=260pt]{namespacecivilsage_1_1views_a8b58c93a9c82e84143c43dafaa744a4b_cgraph}
\end{center}
\end{figure}


